<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{/User/layout/layout :: mainContent('Payment Flight',~{this::#content})}">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<main id="content" class="relative block" style="background-color: #ebf0f7 !important;padding-top: 4rem">
    <div class="container">
        <form class="js-validate" th:action="@{/payFlight}" method="get">
            <div class="row">

                <div class="col-lg-8 col-xl-8">
                    <div class="mb-5 shadow-soft"
                         style="background-color: white;border-radius: 0.25rem!important;box-shadow: 0 3px 6px 0 rgba(140, 152, 164, 0.25) !important">
                        <div class="py-3 px-4 px-xl-12 border-bottom">

                            <ul class="list-group flex-nowrap  list-group-horizontal list-group-borderless flex-center-between pt-1">
                                <li class="list-group-item text-center flex-shrink-0 flex-xl-shrink-1">
                                    <div class="mr-auto ml-auto border mb-2"
                                         style="display: flex;align-items: center;justify-content: center;border-width: 2px;color: white;border-color: #297cbb !important;border-radius: 50% !important;width: 2.5rem;height: 2.5rem;border: 1px solid #e7eaf3 !important;background-color: #297cbb !important">
                                        1
                                    </div>
                                    <div style="color: #297cbb !important;font-size: 1rem;font-weight: 400;font-family: 'Rubik', Helvetica, Arial, sans-serif;line-height: 1.5">
                                        Customer information
                                    </div>
                                </li>
                                <li class="list-group-item text-center flex-shrink-0 flex-xl-shrink-1">
                                    <div class="mr-auto ml-auto border mb-2"
                                         style="display: flex;align-items: center;justify-content: center;border-width: 2px;color: #3b444f;border-color: #297cbb !important;border-radius: 50% !important;width: 2.5rem;height: 2.5rem;border: 1px solid #e7eaf3 !important;">
                                        2
                                    </div>
                                    <div style="color: #297cbb !important;font-size: 1rem;font-weight: 400;font-family: 'Rubik', Helvetica, Arial, sans-serif;line-height: 1.5">
                                        Payment information
                                    </div>
                                </li>
                                <li class="list-group-item text-center flex-shrink-0 flex-xl-shrink-1">
                                    <div class="mr-auto ml-auto border mb-2"
                                         style="display: flex;align-items: center;justify-content: center;border-width: 2px;color: #3b444f;border-color: #297cbb !important;border-radius: 50% !important;width: 2.5rem;height: 2.5rem;border: 1px solid #e7eaf3 !important;">
                                        2
                                    </div>
                                    <div style="color: #297cbb !important;font-size: 1rem;font-weight: 400;font-family: 'Rubik', Helvetica, Arial, sans-serif;line-height: 1.5">
                                        Payment information
                                    </div>
                                </li>
                            </ul>
                            <div class="reservation-bar">
                                <span>Chúng tôi đang giữ giá cho quý khách...</span>
                                <div class="icon">🕒</div>
                                <div class="timer" id="countdown">00:01:02</div>
                            </div>
                            <input type="hidden" th:value="${timeout}" id="timeout">
                        </div>
                        <div class="pt-4 pb-5 px-5">
                            <h5 id="scroll-description" class="text-dark mb-4"
                                style="font-size: 1.313rem;font-weight: 500 !important;font-family: 'Rubik', Helvetica, Arial, sans-serif;text-align: left">
                                Let Us Know Who You Are
                            </h5>

                            <div class="row">
                                <div class="col-sm-6 mb-4">
                                    <div class="js-form-message">
                                        <label class="form-label"
                                               style="font-family: 'Rubik', Helvetica, Arial, sans-serif;font-size: 1.2rem;font-weight: 400;line-height: 1.5;color: #3b444f">
                                            First Name
                                        </label>
                                        <input type="text" class="form-control"
                                               placeholder="First Name"
                                               style="padding: 0.9rem 1rem;height: calc(1.5em + 1.8rem + 4px);border: 3px solid #ebf0f7;color: #3b444f">
                                    </div>
                                </div>
                                <div class="col-sm-6 mb-4">
                                    <div class="js-form-message">
                                        <label class="form-label"
                                               style="font-family: 'Rubik', Helvetica, Arial, sans-serif;font-size: 1.2rem;font-weight: 400;line-height: 1.5;color: #3b444f">
                                            Last Name
                                        </label>
                                        <input type="text" class="form-control" placeholder="Last Name"
                                               style="padding: 0.9rem 1rem;height: calc(1.5em + 1.8rem + 4px);border: 3px solid #ebf0f7;color: #3b444f">
                                    </div>
                                </div>
                                <div class="col-sm-6 mb-4">
                                    <div class="js-form-message">
                                        <label class="form-label"
                                               style="font-family: 'Rubik', Helvetica, Arial, sans-serif;font-size: 1.2rem;font-weight: 400;line-height: 1.5;color: #3b444f">
                                            Email
                                        </label>
                                        <input type="text" class="form-control" placeholder="Email"
                                               style="padding: 0.9rem 1rem;height: calc(1.5em + 1.8rem + 4px);border: 3px solid #ebf0f7;color: #3b444f">
                                    </div>
                                </div>
                                <div class="col-sm-6 mb-4">
                                    <div class="js-form-message">
                                        <label class="form-label"
                                               style="font-family: 'Rubik', Helvetica, Arial, sans-serif;font-size: 1.2rem;font-weight: 400;line-height: 1.5;color: #3b444f">
                                            Phone
                                        </label>
                                        <input type="tel" class="form-control" placeholder="Phone"
                                               style="padding: 0.9rem 1rem;height: calc(1.5em + 1.8rem + 4px);border: 3px solid #ebf0f7;color: #3b444f">
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="js-form-message mb-6">
                                        <label class="form-label">
                                            Special Requirements
                                        </label>
                                        <div class="input-group">
                                            <textarea class="form-control" rows="4"
                                                      style="border: 2px solid #ebf0f7"></textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="w-100"></div>
                                <div class="col-sm-6 mb-10 mt-4 mb-4">
                                    <div class="js-form">
                                        <h5 id="scroll-description" class="mb-2"
                                            style="font-size: 1.313rem;font-weight: 500 !important;color: #3b444f !important">
                                            Let Us know</h5>
                                        <p style="color: #77838f;line-height: 1.7;font-size: 16px;margin-top: 0;margin-bottom: 1rem;font-family: 'Rubik', Helvetica, Arial, sans-serif">
                                            We'll let the property or host know when to expect you.
                                        </p>
                                    </div>
                                </div>
                                <div class="col-sm-6 " style="align-self: flex-end !important">
                                    <div class="text-right">
                                        <button type="submit" class="btn transition-3d-hover py-3"
                                                style="background-color: #297cbb;border-color: #297cbb;min-width: 13.75rem;border-radius: 0.25rem !important;font-size: 1rem;font-weight: 500!important;color: white">
                                            NEXT PAGE
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <input type="hidden" name="currency" value="JPY">
                            <input type="hidden" id="amount" step="0.01" class="form-control" name="amount"
                                   placeholder="Enter amount" th:value="${total}" required>


                        </div>
                    </div>
                </div>
                <div class="col-lg-4 col-xl-4">
                    <div class="shadow-soft rounded-sm" style="background-color: #ffffff">
                        <th:block th:each="flights,index :${flight}">
                            <div class="pt-5 pb-3 border-bottom" style="padding-left: 2rem;padding-right: 2rem">
                                <a class="d-block mb-3">
                                    <img class="img-fluid " style="border-radius: 0.188rem;width: 100%"
                                         th:src="'http://localhost:8686/images/flight/'+${flights.imageUrl}">
                                </a>
                                <a class="mb-1"
                                   style="color: #3b444f !important;font-weight: 500 !important;text-decoration: none;background-color: transparent"
                                   th:text="${flights.nameAirline}">
                                    Indianapolis to paris
                                </a>
                                <div class="mb-2"
                                     style="display: flex;align-items: center;justify-content: space-between">
                                    <div class="flex-horizontal-center" style="color: #67747c !important">Oneway
                                        flight
                                    </div>
                                    <div style="color: #77838f !important">
                                        <a style="text-decoration: underline">Edit</a>
                                    </div>
                                </div>
                                <div class="mb-1"
                                     style="display: flex;align-items: center;justify-content: center;flex-direction: column">
                                    <h6 class=" mb-0"
                                        style="font-weight: 500!important;font-size: 0.875rem;color: #18181b !important"
                                        th:text="${flights.durationString}">02 hrs
                                        45 mins</h6>
                                    <div class="my-1 mt-2 border-top"
                                         style="width: 3.75rem;border-width: 2px !important;border-color: #297cbb !important"></div>
                                    <div style="font-size: 0.875rem;color: #67747c !important;font-family: 'Rubik', Helvetica, Arial, sans-serif">
                                        Non Stop
                                    </div>
                                </div>
                                <div class="flex-horizontal-center justify-content-between">
                                    <div class="flex-horizontal-center">
                                        <div class="mr-2">
                                            <i class="fa-solid fa-plane-departure"
                                               style="font-size: 1.875rem;color: #297cbb !important"></i>
                                        </div>
                                        <div class="ml-1" style="line-height: 1.2">
                                            <h6 class="mb-0" th:text="${flights.timeDepart}"
                                                style="font-weight: 500 !important;font-size: 1.313rem;color: #18181b !important">
                                                18:30</h6>
                                            <span style="font-size: 0.875rem;color: #67747c !important;font-weight: 400 !important;;font-family: 'Rubik', Helvetica, Arial, sans-serif">New Delhi</span>
                                        </div>
                                    </div>
                                    <div class="flex-horizontal-center">
                                        <div class="mr-2">
                                            <i class="fa-solid fa-plane-departure"
                                               style="font-size: 1.875rem;color: #297cbb !important"></i>
                                        </div>
                                        <div class="ml-1" style="line-height: 1.2">
                                            <h6 class="mb-0"
                                                style="font-weight: 500 !important;font-size: 1.313rem;color: #18181b !important"
                                                th:text="${flights.timeArrival}">
                                                18:30</h6>
                                            <span style="font-size: 0.875rem;color: #67747c !important;font-weight: 400 !important;;font-family: 'Rubik', Helvetica, Arial, sans-serif">New Delhi</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </th:block>

                        <div id="basicsCollapseTwo" class="collapse show">
                            <div class="card-body px-4 pt-0">
                                <ul class="list-unstyled mb-0" style="font-size: 1rem">
                                    <li class="d-flex justify-content-between py-2">
                                        <span style="font-weight: 500 !important;font-size: 1rem;font-family: 'Rubik', Helvetica, Arial, sans-serif;line-height: 1.5;color: #3b444f">seat Price</span>
                                        <span style="color: #77838f !important;font-family: 'Rubik', Helvetica, Arial, sans-serif;font-weight: 400;line-height: 1.5"
                                              id="SeatPrice">$0</span>
                                    </li>
                                    <li class="d-flex justify-content-between py-2">
                                        <span style="font-weight: 500 !important;font-size: 1rem;font-family: 'Rubik', Helvetica, Arial, sans-serif;line-height: 1.5;color: #3b444f">Baggage Price</span>
                                        <span style="color: #77838f !important;font-family: 'Rubik', Helvetica, Arial, sans-serif;font-weight: 400;line-height: 1.5"
                                              id="BaggagePrice">$0</span>
                                    </li>

                                    <li class="d-flex justify-content-between py-2">
                                        <span style="font-weight: 500 !important;font-size: 1rem;font-family: 'Rubik', Helvetica, Arial, sans-serif;line-height: 1.5;color: #3b444f">Pay Amount</span>
                                        <span style="font-family: 'Rubik', Helvetica, Arial, sans-serif;font-weight: 500;line-height: 1.5" id="totalPriceBooking"
                                              th:text="'$'+${total}">€580,00</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <input type="hidden" id="bookings" name="bookings">

            </div>
        </form>
        <div class="row">
            <div class="col-lg-8 col-xl-8">
                <div class="mb-5 shadow-soft"
                     style="background-color: white;border-radius: 0.25rem!important;box-shadow: 0 3px 6px 0 rgba(140, 152, 164, 0.25) !important">
                    <div class="seat-selection-container">
                        <div class="header">
                            <i class="fa-solid fa-chair"></i>
                            <h2>Lựa chọn chỗ ngồi</h2>
                        </div>
                        <p>Tuyệt vời, hành trình này cho quý khách lựa chọn chỗ ngồi! Nếu quý khách không lựa chọn chỗ
                            ngồi bây giờ thì hãng hàng không có thể ngẫu nhiên xếp cho quý khách một chỗ ngồi hoặc cho
                            phép quý khách lựa chọn từ những chỗ ngồi còn lại khi quý khách làm thủ tục.</p>
                        <th:block th:each="flights,index : ${flight}">
                            <div class="flight-info"
                                 style="background-color: #f5f5f5;padding: 10px;border-radius: 5px;margin-bottom: 10px;display: none">
                                <h3>Chuyến đi</h3>
                                <div class="route">
                                    <img alt="Vietjet Logo"> <span
                                        th:text="${flights.departureAirport}+'  -  '+${flights.arrivalAirport}">HAN - NRT</span>
                                </div>
                                <div class="passengers" th:id="'passagers'+${flights.id}">

                                </div>
                            </div>
                        </th:block>


                        <p class="note" style="display: none">Việc xếp chỗ ngồi có thể thay đổi vì lý do an toàn hoặc
                            vận hành</p>

                        <div class="price"
                             style="font-size: 1.2em;font-weight: bold;margin-bottom: 15px;color: red;display: none">
                            + 531.282 ₫
                        </div>
                        <div class="footer" style="display: block;text-align: right">
                            <button class="edit-button">Sửa lựa chọn chỗ ngồi</button>
                        </div>

                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-8 col-xl-8">
                <div class="baggage-container mb-4">
                    <div class="baggage-header">Hành lý</div>

                    <!-- Hà Nội (HAN) -> Hồ Chí Minh (SGN) -->
                    <th:block th:each="flights,index : ${flight}">
                        <div class="route">
                            <div class="route-info">
                                <div class="route-header" th:text="${flights.departureAirport}+' ->  '+${flights.arrivalAirport}">Hà Nội (HAN) → Hồ Chí Minh (SGN)</div>
                                <div class="baggage-info" >Mỗi hành khách đã bao gồm: <span
                                        class="carry-on" >Xách tay 7 kg</span></div>
                                <div class="baggage-info" th:id="'baggage-info-'+${flights.id}" style="display: none">Đã thêm: <span
                                        class="added-baggage" th:id="'carry-on-'+${flights.id}">Hành khách 1: Ký gửi 15 kg</span></div>
                            </div>
                            <button type="button" class="action-button" th:data-flight-id="${flights.id}">Chỉnh sửa hành lý</button>
                        </div>
                    </th:block>

                </div>
            </div>
        </div>
    </div>
    <div class="popup">
        <div class="popup-content" style="width: 49%;">
            <span class="close-button">&times;</span>
            <h2>Lựa chọn chỗ ngồi</h2>

            <!-- Tab Navigation -->
            <div class="tab-navigation">
                <th:block th:each="flighttabs, index : ${flightTab}">
                    <button
                            class="tab-link"
                            th:classappend="${index.index == 0} ? 'active' : ''"
                            th:onclick="'openTab(event, ' + ${index.index} + ')'"
                            th:text="${flighttabs.departureAirport.name} + ' -> ' + ${flighttabs.arrivalAirport.name}">
                    </button>
                </th:block>

            </div>

            <!-- Tab Content -->
            <th:block th:each="flighttabs, index : ${flightTab}">
                <div th:id="${index.index}" class="tab-content"
                     th:style="${index.index == 0} ? 'display: block;' : 'display: none;'">
                    <!-- Nội dung Chuyến đi -->
                    <div class="flight-route">HAN - NRT</div>

                    <div class="seat-legend">
                        <!-- Legend Items -->
                        <div class="legend-item">
                            <div class="seat-icon available"></div>
                            First Class
                        </div>
                        <div class="legend-item">
                            <div class="seat-icon legroom"></div>
                            Business Class
                        </div>
                        <div class="legend-item">
                            <div class="seat-icon occupied"></div>
                            0 ₫
                        </div>
                        <div class="legend-item">
                            <div class="seat-icon isSelected"><i class="fas fa-user"></i></div>
                            Được chọn
                        </div>
                        <div class="legend-item">
                            <i class="fas fa-times"></i> Không chọn được
                        </div>
                        <div class="legend-item">
                            <i class="fas fa-person-booth"></i> Thêm chỗ duỗi chân
                        </div>
                    </div>
                    <div class="container">
                        <div class="row">
                            <div class=""
                                 style="display: flex;flex-direction: column;width: 32%;height: 300px; overflow-y: auto;">
                                <th:block th:each="num, index : ${#numbers.sequence(1, number)}">
                                    <div th:class="'passenger-info tab-passage'+${flighttabs.id}"
                                         style="height: 11vh;width: 65%">
                                        <div class="passenger-block">
                                            <div class="passenger-type">
                                                <div th:class="'selected-seat seat-tabs'+${flighttabs.id}"><span
                                                        th:text="${num}">1A</span></div>
                                                Người lớn <span class="span-index" th:text="${index.index+1}">1</span>
                                            </div>
                                            <div class="seat-info">
                                                <span class="seat-price">442.523 ₫</span>
                                            </div>
                                        </div>
                                    </div>
                                </th:block>

                                <input type="hidden" id="numberPeople" th:value="${number}">
                            </div>

                            <div class="seat-container col-6" style="margin-left: 7vh">
                                <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                                    <!-- Passenger Information -->

                                    <!-- Seat Grid -->
                                    <div style="text-align: center; max-height: 300px; overflow-y: auto; border: 1px solid #ddd; padding: 10px; border-radius: 8px;"
                                         th:class="'seat-grid'+${flighttabs.id}">
                                        <!-- Seat Header -->
                                        <div style="display: flex; justify-content: center; margin-bottom: 5px; font-weight: bold;">
                                            <div style="width: 30px; margin: 5px;">A</div>
                                            <div style="width: 30px; margin: 5px;">B</div>
                                            <div style="width: 30px; margin: 5px;">C</div>
                                            <div style="width: 30px;margin: 5px;margin-left: 43px;">D</div>
                                            <div style="width: 30px; margin: 5px;">E</div>
                                            <div style="width: 30px; margin: 5px;">F</div>
                                        </div>

                                        <!-- Seat Rows -->
                                        <div style="display: flex; flex-direction: column; align-items: center; margin-bottom: 5px;">
                                            <!-- Row 1 -->
                                            <div style="display: flex; align-items: center; justify-content: center; margin-bottom: 5px; gap: 10px;">
                                                <!-- Left seats -->
                                                <div style="display: flex; gap: 5px;">
                                                    <div style="width: 30px; height: 30px; background-color: #dcdcdc; border-radius: 4px;"></div>
                                                    <div style="width: 30px; height: 30px; background-color: #dcdcdc; border-radius: 4px;"></div>
                                                    <div style="width: 30px; height: 30px; background-color: #dcdcdc; border-radius: 4px;"></div>
                                                </div>

                                                <!-- Row number -->
                                                <div style="width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; font-weight: bold;">
                                                    1
                                                </div>

                                                <!-- Right seats -->
                                                <div style="display: flex; gap: 5px;">
                                                    <div style="width: 30px; height: 30px; background-color: #dcdcdc; border-radius: 4px;"></div>
                                                    <div style="width: 30px; height: 30px; background-color: #dcdcdc; border-radius: 4px;"></div>
                                                    <div style="width: 30px; height: 30px; background-color: #dcdcdc; border-radius: 4px;"></div>
                                                </div>
                                            </div>

                                            <!-- Row 2 -->
                                            <div style="display: flex; align-items: center; justify-content: center; margin-bottom: 5px; gap: 10px;">
                                                <!-- Left seats -->
                                                <div style="display: flex; gap: 5px;">
                                                    <div style="width: 30px; height: 30px; background-color: #a7d2ff; border-radius: 4px;"></div>
                                                    <div style="width: 30px; height: 30px; background-color: #a7d2ff; border-radius: 4px;"></div>
                                                    <div style="width: 30px; height: 30px; background-color: #7199ff; border-radius: 4px;"></div>
                                                </div>

                                                <!-- Row number -->
                                                <div style="width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; font-weight: bold;">
                                                    2
                                                </div>

                                                <!-- Right seats -->
                                                <div style="display: flex; gap: 5px;">
                                                    <div style="width: 30px; height: 30px; background-color: #7199ff; border-radius: 4px;"></div>
                                                    <div style="width: 30px; height: 30px; background-color: #2c4aff; border-radius: 4px;"></div>
                                                    <div style="width: 30px; height: 30px; background-color: #2c4aff; border-radius: 4px;"></div>
                                                </div>
                                            </div>

                                            <!-- Add more rows as needed -->
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <!-- Seat Grid for Chuyến đi -->


            </th:block>
            <input type="hidden" th:value="${idFlight}" id="idFlight">

            <div class="footer-popup" style="display: flex; justify-content: space-between">
                <div class="total-price">
                    Tổng số phụ: <span id="totalPrice">0 ₫</span>
                </div>

                <button class="confirm-button">Xong</button>
            </div>
        </div>
    </div>
    <th:block th:each="flights,index : ${flight}">
        <div class="popup-overlay" th:id="'popup-'+${flights.id}" style="display: none">
            <div class="popup-buggage">
                <div class="popup-header" style="position: relative">
                    <h3>Thêm hành lý</h3>
                    <span class="close-button" style="top: 14px">&times;</span>
                </div>
                <div class="popup-body" style="padding: 20px">
                    <div class="route-info" style="font-size: 14px;color: #555;margin-bottom: 20px">Hồ Chí Minh (SGN) - Hà
                        Nội (HAN)
                    </div>
                    <ul class="baggage-options">
                        <li>
                            <label>
                                <input type="radio"  value="0" th:name="'baggage-'+${flights.id}">
                                Không có hành lý ký gửi
                            </label>
                            <span class="price">0 đ</span>
                        </li>
                        <li>
                            <label>
                                <input type="radio" th:name="'baggage-'+${flights.id}" value="20">
                                20 kg
                            </label>
                            <span class="price">381.134 đ</span>
                            <input type="hidden" value="381134" class="price-input">
                        </li>
                        <li>
                            <label>
                                <input type="radio" th:name="'baggage-'+${flights.id}" value="30">
                                30 kg
                            </label>
                            <span class="price">566.234 đ</span>
                            <input type="hidden" value="566234" class="price-input">
                        </li>
                        <li>
                            <label>
                                <input type="radio" th:name="'baggage-'+${flights.id}" value="40">
                                40 kg
                            </label>
                            <span class="price">756.929 đ</span>
                            <input type="hidden" value="756929" class="price-input">
                        </li>
                        <li>
                            <label>
                                <input type="radio" th:name="'baggage-'+${flights.id}" value="50">
                                50 kg
                            </label>
                            <span class="price">941.775 đ</span>
                            <input type="hidden" value="941775" class="price-input">
                        </li>
                        <li>
                            <label>
                                <input type="radio" th:name="'baggage-'+${flights.id}" value="60">
                                60 kg
                            </label>
                            <span class="price">1.132.469 đ</span>
                            <input type="hidden" value="1132469" class="price-input">
                        </li>
                        <li>
                            <label>
                                <input type="radio" th:name="'baggage-'+${flights.id}" value="70">
                                70 kg
                            </label>
                            <span class="price">1.323.163 đ</span>
                            <input type="hidden" value="1323163" class="price-input">
                        </li>
                    </ul>
                    <div class="popup-footer">
                        <button class="cancel-button">
                            Cancel
                        </button>
                        <button class="confirm-btn" th:data-flight-id="${flights.id}" th:data-flight-index="${index.index+1}">Confirm</button>
                    </div>
                </div>
            </div>
        </div>

    </th:block>

    <script th:fragment="customScripts" th:src="@{/user/Payment/Payment.js}"></script>
</main>

</body>
</html>